<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [net-tools-cvscommit] net-tools netstat.c,1.63,1.64
   </TITLE>
   <LINK REL="Index" HREF="http://lists.berlios.de/pipermail/net-tools-cvscommit/2009q3/index.html" >
   <LINK REL="made" HREF="mailto:net-tools-cvscommit%40lists.berlios.de?Subject=Re%3A%20%5Bnet-tools-cvscommit%5D%20net-tools%20netstat.c%2C1.63%2C1.64&In-Reply-To=%3C20090728014019.20F4518770D%40mail.berlios.de%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000052.html">
   <LINK REL="Next"  HREF="000054.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[net-tools-cvscommit] net-tools netstat.c,1.63,1.64</H1>
    <B>CVS Commits for net-tools project</B> 
    <A HREF="mailto:net-tools-cvscommit%40lists.berlios.de?Subject=Re%3A%20%5Bnet-tools-cvscommit%5D%20net-tools%20netstat.c%2C1.63%2C1.64&In-Reply-To=%3C20090728014019.20F4518770D%40mail.berlios.de%3E"
       TITLE="[net-tools-cvscommit] net-tools netstat.c,1.63,1.64">net-tools-cvscommit at lists.berlios.de
       </A><BR>
    <I>Tue Jul 28 03:40:19 CEST 2009</I>
    <P><UL>
        <LI>Previous message: <A HREF="000052.html">[net-tools-cvscommit] net-tools netstat.c, 1.62, 1.63 arp.c, 1.25,	1.26
</A></li>
        <LI>Next message: <A HREF="000054.html">[net-tools-cvscommit] net-tools/po cs.po,1.2,1.3
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#53">[ date ]</a>
              <a href="thread.html#53">[ thread ]</a>
              <a href="subject.html#53">[ subject ]</a>
              <a href="author.html#53">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Update of /cvsroot/net-tools/net-tools
In directory sheep:/tmp/cvs-serv15612

Modified Files:
	netstat.c 
Log Message:
Avoid name resolution for listening or established sockets (-l) by return
fast. Problem reported by Ragnar Hojland Espinosa &lt;<A HREF="https://lists.berlios.de/mailman/listinfo/net-tools-cvscommit">ragnar at ragnar-hojland.com</A>&gt;


Index: netstat.c
===================================================================
RCS file: /cvsroot/net-tools/net-tools/netstat.c,v
retrieving revision 1.63
retrieving revision 1.64
diff -C2 -d -r1.63 -r1.64
*** netstat.c	8 Jul 2009 00:24:03 -0000	1.63
--- netstat.c	28 Jul 2009 01:40:17 -0000	1.64
***************
*** 728,731 ****
--- 728,734 ----
  		 &amp;txq, &amp;rxq, &amp;timer_run, &amp;time_len, &amp;retr, &amp;uid, &amp;timeout, &amp;inode, more);
  
+     if (!flag_all &amp;&amp; ((flag_lst &amp;&amp; rem_port) || (!flag_lst &amp;&amp; !rem_port)))
+       return;
+ 
      if (strlen(local_addr) &gt; 8) {
  #if HAVE_AFINET6
***************
*** 766,770 ****
      safe_strncpy(rem_addr, ap-&gt;sprint((struct sockaddr *) &amp;remaddr, flag_not),
  		 sizeof(rem_addr));
!     if (flag_all || (flag_lst &amp;&amp; !rem_port) || (!flag_lst &amp;&amp; rem_port)) {
  	snprintf(buffer, sizeof(buffer), &quot;%s&quot;,
  		 get_sname(htons(local_port), &quot;tcp&quot;,
--- 769,773 ----
      safe_strncpy(rem_addr, ap-&gt;sprint((struct sockaddr *) &amp;remaddr, flag_not),
  		 sizeof(rem_addr));
! 
  	snprintf(buffer, sizeof(buffer), &quot;%s&quot;,
  		 get_sname(htons(local_port), &quot;tcp&quot;,
***************
*** 820,824 ****
  
  	finish_this_one(uid,inode,timers);
-     }
  }
  
--- 823,826 ----


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000052.html">[net-tools-cvscommit] net-tools netstat.c, 1.62, 1.63 arp.c, 1.25,	1.26
</A></li>
	<LI>Next message: <A HREF="000054.html">[net-tools-cvscommit] net-tools/po cs.po,1.2,1.3
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#53">[ date ]</a>
              <a href="thread.html#53">[ thread ]</a>
              <a href="subject.html#53">[ subject ]</a>
              <a href="author.html#53">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.berlios.de/mailman/listinfo/net-tools-cvscommit">More information about the net-tools-cvscommit
mailing list</a><br>
</body></html>
